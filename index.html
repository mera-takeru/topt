<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>pertonal -パートナル- | 「音」と「色」でわかる新感覚の性格診断</title>
  <link rel="canonical" href="https://pertonal.jp">
  <meta property="og:url" content="https://pertonal.jp">
  <meta name="description" content="【完全無料】音と色であなたの本当の性格がわかる新感覚の性格診断「パートナル」。全24タイプのキャラクターから、自分や友達の新しい一面を発見しよう！MBTIの次はコレ！">
  <link rel="icon" href="https://gray-magnificent-deer-836.mypinata.cloud/ipfs/bafkreigaj4jljhdjkoavf2tdarmpyzfalutwxnnmmhrb437soizt2peewe" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="パートナル - 音と色の性格診断">
  <meta name="twitter:description" content="音と色であなたの性格を診断！MBTIの次はコレ！今すぐ無料でチェック！">
  <meta name="twitter:image" content="https://ipfs.io/ipfs/bafybeifuttq27ioeycupsnmuj4u2kuvjtmg4ibhtxualf6mti2yxa5abbe">
  <meta property="og:image" content="https://ipfs.io/ipfs/bafybeifuttq27ioeycupsnmuj4u2kuvjtmg4ibhtxualf6mti2yxa5abbe">

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7664351285167114"
     crossorigin="anonymous"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-M1HFSG9FVD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M1HFSG9FVD');
</script>

<style>
    /* ブログ紹介セクション用の追加CSS */
    #blog-section {
      width: 100%;
      max-width: 600px;
      margin: 12px auto 12px;
      padding: 12px;
      background: #fff;
      border-radius: var(--radius);
      text-align: center;
      border: 4px solid var(--primary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    #blog-section h3 {
      font-weight: 700;
      font-size: 1.25rem;
      margin-bottom: 12px;
      color: var(--primary);
      text-shadow: 
        1px 1px 2px rgba(0, 0, 0, 0.3),
        0 0 4px rgba(255, 255, 255, 0.5);
      letter-spacing: 0.5px;
    }

    .blog-description {
      font-size: 0.875rem;
      line-height: 1.6;
      color: var(--text);
      margin-bottom: 16px;
      padding: 0 12px;
      text-align: left;
    }

    #blogBtn {
      width: 100%;
    }
</style>

</head>
<body>

  <header>
    <nav class="header-nav">
      <a href="/about">パートナルとは</a><span class="divider">|</span>
      <a href="/faq">よくある質問</a><span class="divider">|</span>
      <a href="https://forms.gle/PstFm54KustR4zKs6">お問い合わせ</a>
    </nav>
  </header>
  
  <div class="container">
    <h1>
      <span class="title-topt">
        <span class="title-english">pertonal</span>
        <span class="title-japanese"> -パートナル-</span>
      </span>
      <span class="title-sub">「音」×「色」＝ New「性格診断」</span>
    </h1>

    <div id="startScreen" class="screen active">
      <div class="start-image">
          <video data-poster-pc="https://gray-magnificent-deer-836.mypinata.cloud/ipfs/bafybeibt2ji6bsjz4goa4atguygxinttkcbecfpbvfj2xmwns6dle6oyt4/PC%E3%83%A1%E3%82%A4%E3%83%B3.webp" data-poster-mobile="https://gray-magnificent-deer-836.mypinata.cloud/ipfs/bafybeibt2ji6bsjz4goa4atguygxinttkcbecfpbvfj2xmwns6dle6oyt4/%E3%82%B9%E3%83%9E%E3%83%9B%E3%83%A1%E3%82%A4%E3%83%B3.webp" autoplay loop muted playsinline alt="メイン画像">
          <source src="https://gray-magnificent-deer-836.mypinata.cloud/ipfs/bafybeibt2ji6bsjz4goa4atguygxinttkcbecfpbvfj2xmwns6dle6oyt4/PC%E3%83%A1%E3%82%A4%E3%83%B3.webm" media="(min-width: 601px)" type="video/webm">
          <source src="https://gray-magnificent-deer-836.mypinata.cloud/ipfs/bafybeibt2ji6bsjz4goa4atguygxinttkcbecfpbvfj2xmwns6dle6oyt4/PC%E3%83%A1%E3%82%A4%E3%83%B3.mp4" media="(min-width: 601px)" type="video/mp4">
          <source src="https://gray-magnificent-deer-836.mypinata.cloud/ipfs/bafybeibt2ji6bsjz4goa4atguygxinttkcbecfpbvfj2xmwns6dle6oyt4/%E3%82%B9%E3%83%9E%E3%83%9B%E3%83%A1%E3%82%A4%E3%83%B3.webm" media="(max-width: 600px)" type="video/webm">
          <source src="https://gray-magnificent-deer-836.mypinata.cloud/ipfs/bafybeibt2ji6bsjz4goa4atguygxinttkcbecfpbvfj2xmwns6dle6oyt4/%E3%82%B9%E3%83%9E%E3%83%9B%E3%83%A1%E3%82%A4%E3%83%B3.mp4" media="(max-width: 600px)" type="video/mp4">
          お使いのブラウザは動画の再生に対応していません。
        </video>
      </div>
      <button id="startBtn">
          <span class="arrows arrows-left">
            <span>▶︎</span>
            <span>▶︎</span>
            <span>▶︎</span>
          </span>
          <span class="btn-text"> 今すぐ無料診断 </span>
          <span class="arrows arrows-right">
            <span>◀︎</span>
            <span>◀︎</span>
            <span>◀︎</span>
          </span>
      </button>
    </div>

    <div id="questionScreen" class="screen">
      <div class="progress-bar"><div id="progInner" class="progress-inner"></div></div>
      <div class="question"><h2 id="questionText"></h2></div>
      <ul id="optionsList" class="options"></ul>
      <div class="nav"><button id="backBtn">◀︎ 1つ前へ</button></div>
    </div>
  </div>

  <div id="lucky-pertonal-section">
      <h3>✨今日のラッキーパートナル✨</h3>
      <div id="lucky-pertonal-display">
        <span id="lucky-pertonal-1"></span>
        <span id="lucky-pertonal-2"></span>
      </div>
     <p class="lucky-description">「ラッキーパートナル」は、調性の父・ラモーの誕生日を起点とするオリジナルの占いです。音楽理論に基づいて、幸運なパートナルのペアが日替わりで決まります。</p>
  </div>

   <div id="compatibility-section">
    <h3>🤝パートナル相性診断🤝</h3>
    <p class="compatibility-description">あなたとあの人との気になる相性が判明！2つのパートナルを選ぶだけで、関係性や付き合い方のアドバイスがわかります。</p>
    <button id="compatibilityBtn" onclick="location.href='/compatibility'">相性を見る</button>
  </div>

  <div id="blog-section">
    <h3>📝パートナル公式ブログ📝</h3>
    <p class="blog-description">パートナルの開発秘話や各パートナルの詳細解説、相性診断などの様々なコンテンツを定期的に発信していく予定です。どうぞお楽しみに！</p>
    <button id="blogBtn" disabled style="background-color: #ccc; cursor: not-allowed;">近日公開</button>
  </div>

  <!--　<div id="blog-section">
    <h3>📝メラの開発者ブログ📝</h3>
    <p class="blog-description">パートナルの開発秘話や各パートナルの詳細解説、相性診断などのさまざまなコンテンツを定期的に発信していきます。</p>
    <button id="blogBtn" onclick="location.href='/blog'">ブログを読む</button>　-->

  <script src="/data.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      let currentQuestionIndex = 0;
      const userAnswers = Array(questions.length).fill(null);
      let isSubmitting = false;

      const startBtn = document.getElementById('startBtn');
      const backBtn = document.getElementById('backBtn');
      const startScreen = document.getElementById('startScreen');
      const questionScreen = document.getElementById('questionScreen');
      const questionText = document.getElementById('questionText');
      const optionsList = document.getElementById('optionsList');
      const progInner = document.getElementById('progInner');

      function showScreen(screen) {
        startScreen.classList.remove('active');
        questionScreen.classList.remove('active');
        screen.classList.add('active');
      }

      function renderQuestion() {
        const q = questions[currentQuestionIndex];
        questionText.textContent = q.text;
        progInner.style.width = `${(currentQuestionIndex / questions.length) * 100}%`;
        optionsList.innerHTML = '';

        q.options.forEach((opt, idx) => {
          const li = document.createElement('li');
          if (userAnswers[currentQuestionIndex] === idx) {
            li.classList.add('selected');
          }
          const btn = document.createElement('button');
          btn.textContent = opt.text;
          btn.onclick = () => {
            userAnswers[currentQuestionIndex] = idx;
            if (currentQuestionIndex < questions.length - 1) {
              currentQuestionIndex++;
              renderQuestion();
            } else {
              calculateAndRedirect();
            }
          };
          li.appendChild(btn);
          optionsList.appendChild(li);
        });
        backBtn.style.display = currentQuestionIndex > 0 ? 'inline-block' : 'none';
      }

      function calculateAndRedirect() {
        if (isSubmitting) return;
        isSubmitting = true;

        const tieBreakerOrder = ["C", "am", "G", "em", "F", "dm", "D", "bm", "B♭", "gm", "A", "f♯m", "E♭", "cm", "E", "c♯m", "A♭", "fm", "B", "g♯m", "D♭", "b♭m", "F♯", "e♭m"];
        const totals = {};
        questions.forEach((q, qi) => {
          const selectedOptionIndex = userAnswers[qi];
          if (selectedOptionIndex !== null) {
            const points = q.options[selectedOptionIndex].points;
            Object.entries(points).forEach(([key, value]) => {
              totals[key] = (totals[key] || 0) + value;
            });
          }
        });
        if (Object.keys(totals).length === 0) {
          alert('エラーが発生しました。もう一度お試しください。');
          showScreen(startScreen);
          isSubmitting = false;
          return;
        }
        const maxScore = Math.max(...Object.values(totals));
        const tiedResults = Object.keys(totals).filter(key => totals[key] === maxScore);
        let resultKey;
        if (tiedResults.length > 1) {
          resultKey = tieBreakerOrder.find(key => tiedResults.includes(key));
        } else {
          resultKey = tiedResults[0];
        }

        if (resultKey) {
          try {
            const webAppUrl = 'https://script.google.com/macros/s/AKfycby85hMd3E8tD_p5JGqQG_eG4PMW-TFCg0EHhSOY7Eoht-CSoiDuG_2eqfgBWOvYaOM/exec';
            const data = JSON.stringify({ partonal: resultKey });
            if (navigator.sendBeacon) {
              navigator.sendBeacon(webAppUrl, data);
            } else {
              fetch(webAppUrl, { method: 'POST', body: data, mode: 'no-cors', keepalive: true });
            }
          } catch (error) {
            console.error('結果の送信に失敗しました:', error);
          }
          const fileName = resultKey.replace('♯', 's').replace('♭', 'b');
          window.location.href = `${fileName}.html`;
        } else {
          alert('エラーが発生しました。もう一度お試しください。');
          showScreen(startScreen);
          isSubmitting = false;
        }
      }

      startBtn.onclick = () => {
        document.getElementById('lucky-pertonal-section').style.display = 'none';
        document.getElementById('compatibility-section').style.display = 'none'; 
        document.getElementById('blog-section').style.display = 'none';
        currentQuestionIndex = 0;
        userAnswers.fill(null);
        renderQuestion();
        showScreen(questionScreen);
      };

      backBtn.onclick = () => {
        if (currentQuestionIndex > 0) {
          currentQuestionIndex--;
          renderQuestion();
        }
      };
      
　　　function displayLuckyPertonal() {
        const startDate = new Date('1683-09-25T00:00:00Z');
        const now = new Date();
        const today = new Date(now.toLocaleString("en-US", {timeZone: "Asia/Tokyo"}));
        today.setHours(0, 0, 0, 0);

        const pertonalPairs = [
          { major: "C", minor: "am" }, { major: "G", minor: "em" },
          { major: "D", minor: "bm" }, { major: "A", minor: "f♯m" },
          { major: "E", minor: "c♯m" }, { major: "B", minor: "g♯m" },
          { major: "F♯", minor: "e♭m" }, { major: "D♭", minor: "b♭m" },
          { major: "A♭", minor: "fm" }, { major: "E♭", minor: "cm" },
          { major: "B♭", minor: "gm" }, { major: "F", minor: "dm" }
        ];

        const elapsedMilliseconds = today - startDate;
        const elapsedDays = Math.floor(elapsedMilliseconds / (1000 * 60 * 60 * 24));
        const luckyIndex = elapsedDays % 12;

        const luckyPair = pertonalPairs[luckyIndex];
        
        function getCharacterTitle(key) {
          const description = characterDescriptions[key];
          if (!description) return `【${key}型】`;
          const match = description.match(/<span class="title"[^>]*>【.*?】(.*?)<\/span>/);
          return match ? `【${key}型】${match[1]}` : `【${key}型】`;
        }
        
        const luckyPertonal1 = document.getElementById('lucky-pertonal-1');
        const luckyPertonal2 = document.getElementById('lucky-pertonal-2');

        // ★★★ ここからが変更箇所 ★★★
        const fileNameMajor = luckyPair.major.replace('♯', 's').replace('♭', 'b');
        luckyPertonal1.innerHTML = `<a href="./${fileNameMajor}.html">${getCharacterTitle(luckyPair.major)}</a>`;
        luckyPertonal1.style.backgroundColor = personalityColors[luckyPair.major].code;
        
        const fileNameMinor = luckyPair.minor.replace('♯', 's').replace('♭', 'b');
        luckyPertonal2.innerHTML = `<a href="./${fileNameMinor}.html">${getCharacterTitle(luckyPair.minor)}</a>`;
        luckyPertonal2.style.backgroundColor = personalityColors[luckyPair.minor].code;
        // ★★★ ここまでが変更箇所 ★★★
      }
      
      displayLuckyPertonal();
      
    const videoElement = document.querySelector('#startScreen video');
      if (videoElement) {
        const mobilePoster = videoElement.getAttribute('data-poster-mobile');
        const pcPoster = videoElement.getAttribute('data-poster-pc');
        
        if (window.innerWidth <= 600 && mobilePoster) {
          videoElement.setAttribute('poster', mobilePoster);
        } else {
          videoElement.setAttribute('poster', pcPoster);
        }

        videoElement.play().catch(error => {
          console.log("Autoplay failed, waiting for user interaction.", error);
          document.body.addEventListener('touchstart', () => {
            videoElement.play();
          }, { once: true });
        });
      }
    });
  </script>
　 <script src="/footer.js"></script>
</body>
</html>
